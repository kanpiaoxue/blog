#Spring Boot Actuator metrics monitoring with Prometheus and Grafana
###发表时间：2018-09-28
###分类：Spring,springboot,java,springboot-actuator
###iteye原始地址：<a href="https://kanpiaoxue.iteye.com/admin/blogs/2431485" target="_blank">https://kanpiaoxue.iteye.com/admin/blogs/2431485</a>

---

<div class="iteye-blog-content-contain" style="font-size: 14px;"> 
 <p>&nbsp;</p> 
 <p>参考地址：&nbsp;<a href="https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/">https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/</a></p> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <h1 class="post-title" style="">Spring Boot Actuator metrics monitoring with Prometheus and Grafana</h1> 
 <p>&nbsp;</p> 
 <p style="">Welcome to the second part of the Spring Boot Actuator tutorial series. In the&nbsp;<span style="font-weight: 600;"><a style="background-color: transparent; color: #419be8;" href="https://www.callicoder.com/spring-boot-actuator/">first part</a></span>, you learned what&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">spring-boot-actuator</code>&nbsp;module does, how to configure it in a spring boot application, and how to interact with various actuator endpoints.</p> 
 <p style="">In this article, you’ll learn how to integrate spring boot actuator with a monitoring system called&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://prometheus.io/">Prometheus</a>and a graphing solution called&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://grafana.com/">Grafana</a>.</p> 
 <p style="">At the end of this article, you’ll have a Prometheus as well as a Grafana dashboard setup in your local machine where you’ll be able to visualize and monitor all the metrics generated from the Spring Boot application.</p> 
 <div class="adsense-code-block" style="">
  <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;"><ins id="aswift_0_expand" style="display: inline-table; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;"><ins id="aswift_0_anchor" style="display: block; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;">&lt;iframe id="aswift_0" style="box-sizing: border-box; left: 0px; position: absolute; top: 0px; width: 300px; height: 250px;" name="aswift_0" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="300" height="250"&gt;&lt;/iframe&gt;</ins></ins></ins>
 </div> 
 <h2 id="prometheus" style="">Prometheus</h2> 
 <p style="">Prometheus is an open-source monitoring system that was originally built by&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://soundcloud.com/">SoundCloud</a>. It consists of the following core components -</p> 
 <ul style=""> 
  <li style=""> <p style="margin-bottom: 15px;">A data scraper that&nbsp;<em style="">pulls</em>&nbsp;metrics data over HTTP periodically at a configured interval.</p> </li> 
  <li style=""> <p style="margin-bottom: 15px;">A&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://en.wikipedia.org/wiki/Time_series">time-series</a>&nbsp;database to store all the metrics data.</p> </li> 
  <li style=""> <p style="margin-bottom: 15px;">A simple user interface where you can visualize, query, and monitor all the metrics.</p> </li> 
 </ul> 
 <h2 id="grafana" style="">Grafana</h2> 
 <p style="">Grafana allows you to bring data from various data sources like Elasticsearch, Prometheus, Graphite, InfluxDB etc, and visualize them with beautiful graphs.</p> 
 <p style="">It also lets you set alert rules based on your metrics data. When an alert changes state, it can notify you over email, slack, or various other channels.</p> 
 <p style=""><em style="">Note that, Prometheus dashboard also has simple graphs. But Grafana’s graphs are way better. That’s why, in this post, we’ll integrate Grafana with Prometheus to import and visualize our metrics data.</em></p> 
 <h2 id="adding-micrometer-prometheus-registry-to-your-spring-boot-application" style="">Adding Micrometer Prometheus Registry to your Spring Boot application</h2> 
 <p style="">Spring Boot uses&nbsp;<a style="background-color: transparent; color: #419be8;" href="http://micrometer.io/">Micrometer</a>, an application metrics facade to integrate actuator metrics with external monitoring systems.</p> 
 <p style="">It supports several monitoring systems like Netflix Atlas, AWS Cloudwatch, Datadog, InfluxData, SignalFx, Graphite, Wavefront, Prometheus etc.</p> 
 <p style="">To integrate actuator with Prometheus, you need to add the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">micrometer-registry-prometheus</code>dependency -</p> 
 <pre class=" language-xml"><code class=" language-xml" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;">&lt;!-- Micrometer Prometheus registry  --&gt;</span>
<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
	<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>io.micrometer<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
	<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>micrometer-registry-prometheus<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
</code></pre> 
 <p style="">Once you add the above dependency, Spring Boot will automatically configure a&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://github.com/micrometer-metrics/micrometer/blob/master/implementations/micrometer-registry-prometheus/src/main/java/io/micrometer/prometheus/PrometheusMeterRegistry.java"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">PrometheusMeterRegistry</code></a>and a&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://github.com/prometheus/client_java/blob/master/simpleclient/src/main/java/io/prometheus/client/CollectorRegistry.java"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">CollectorRegistry</code></a>&nbsp;to collect and export metrics data in a format that can be scraped by a Prometheus server.</p> 
 <p style="">All the application metrics data are made available at an actuator endpoint called&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/prometheus</code>. The Prometheus server can scrape this endpoint to get metrics data periodically.</p> 
 <h2 id="exploring-spring-boot-actuator-s-prometheus-endpoint" style="">Exploring Spring Boot Actuator’s /prometheus Endpoint</h2> 
 <p style="">Let’s explore the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus</code>&nbsp;endpoint that is exposed by Spring Boot when&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">micrometer-registry-prometheus</code>&nbsp;dependency is available on the classpath.</p> 
 <p style="">First of all, you’ll start seeing the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus</code>&nbsp;endpoint on the actuator endpoint-discovery page (<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator</code>) -</p> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-prometheus-endpoint.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-prometheus-endpoint.jpg" alt="Spring Boot Actuator Prometheus Endpoint"></p> 
 <p style="">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus</code>&nbsp;endpoint exposes metrics data in a format that can be scraped by a Prometheus server. You can see the exposed metrics data by navigating to the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus</code>&nbsp;endpoint (<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/prometheus</code>) -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># HELP jvm_buffer_memory_used_bytes An estimate of the memory that the Java virtual machine is using for this buffer pool</span>
<span class="token comment" style="color: #708090;"># TYPE jvm_buffer_memory_used_bytes gauge</span>
jvm_buffer_memory_used_bytes<span class="token punctuation" style="color: #999999;">{</span>id<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"direct"</span>,<span class="token punctuation" style="color: #999999;">}</span> 81920.0
jvm_buffer_memory_used_bytes<span class="token punctuation" style="color: #999999;">{</span>id<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"mapped"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.0
<span class="token comment" style="color: #708090;"># HELP jvm_threads_live The current number of live threads including both daemon and non-daemon threads</span>
<span class="token comment" style="color: #708090;"># TYPE jvm_threads_live gauge</span>
jvm_threads_live 23.0
<span class="token comment" style="color: #708090;"># HELP tomcat_global_received_bytes_total  </span>
<span class="token comment" style="color: #708090;"># TYPE tomcat_global_received_bytes_total counter</span>
tomcat_global_received_bytes_total<span class="token punctuation" style="color: #999999;">{</span>name<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"http-nio-8080"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.0
<span class="token comment" style="color: #708090;"># HELP jvm_gc_pause_seconds Time spent in GC pause</span>
<span class="token comment" style="color: #708090;"># TYPE jvm_gc_pause_seconds summary</span>
jvm_gc_pause_seconds_count<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Allocation Failure"</span>,<span class="token punctuation" style="color: #999999;">}</span> 7.0
jvm_gc_pause_seconds_sum<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Allocation Failure"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.232
jvm_gc_pause_seconds_count<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 1.0
jvm_gc_pause_seconds_sum<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.01
jvm_gc_pause_seconds_count<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of major GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 1.0
jvm_gc_pause_seconds_sum<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of major GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.302
<span class="token comment" style="color: #708090;"># HELP jvm_gc_pause_seconds_max Time spent in GC pause</span>
<span class="token comment" style="color: #708090;"># TYPE jvm_gc_pause_seconds_max gauge</span>
jvm_gc_pause_seconds_max<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Allocation Failure"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.0
jvm_gc_pause_seconds_max<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of minor GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.0
jvm_gc_pause_seconds_max<span class="token punctuation" style="color: #999999;">{</span>action<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"end of major GC"</span>,cause<span class="token operator" style="color: #a67f59;">=</span><span class="token string" style="color: #669900;">"Metadata GC Threshold"</span>,<span class="token punctuation" style="color: #999999;">}</span> 0.0
<span class="token comment" style="color: #708090;"># HELP jvm_gc_live_data_size_bytes Size of old generation memory pool after a full GC</span>
<span class="token comment" style="color: #708090;"># TYPE jvm_gc_live_data_size_bytes gauge</span>
jvm_gc_live_data_size_bytes 5.0657472E7

<span class="token comment" style="color: #708090;">## More data ...... (Omitted for brevity)</span>
</code></pre> 
 <h2 id="downloading-and-running-prometheus-using-docker" style="">Downloading and Running Prometheus using Docker</h2> 
 <h3 id="1-downloading-prometheus" style="">1. Downloading Prometheus</h3> 
 <p style="">You can download the Prometheus docker image using&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">docker pull</code>&nbsp;command like so -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker pull prom/prometheus
</code></pre> 
 <p style="">Once the image is downloaded, you can type&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">docker image ls</code>&nbsp;command to view the list of images present locally -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker image <span class="token function" style="color: #dd4a68;">ls</span>
REPOSITORY                                   TAG                 IMAGE ID            CREATED             SIZE
prom/prometheus                              latest              b82ef1f3aa07        5 days ago          119MB
</code></pre> 
 <h3 id="2-prometheus-configuration-prometheus-yml" style="">2. Prometheus Configuration (prometheus.yml)</h3> 
 <p style="">Next, We need to configure Prometheus to scrape metrics data from Spring Boot Actuator’s&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/prometheus</code>endpoint.</p> 
 <p style="">Create a new file called&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus.yml</code>&nbsp;with the following configurations -</p> 
 <pre class=" language-yaml"><code class=" language-yaml" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># my global config</span>
<span class="token key atrule" style="color: #0077aa;">global</span><span class="token punctuation" style="color: #999999;">:</span>
  <span class="token key atrule" style="color: #0077aa;">scrape_interval</span><span class="token punctuation" style="color: #999999;">:</span>     15s <span class="token comment" style="color: #708090;"># Set the scrape interval to every 15 seconds. Default is every 1 minute.</span>
  <span class="token key atrule" style="color: #0077aa;">evaluation_interval</span><span class="token punctuation" style="color: #999999;">:</span> 15s <span class="token comment" style="color: #708090;"># Evaluate rules every 15 seconds. The default is every 1 minute.</span>
  <span class="token comment" style="color: #708090;"># scrape_timeout is set to the global default (10s).</span>

<span class="token comment" style="color: #708090;"># Load rules once and periodically evaluate them according to the global 'evaluation_interval'.</span>
<span class="token key atrule" style="color: #0077aa;">rule_files</span><span class="token punctuation" style="color: #999999;">:</span>
  <span class="token comment" style="color: #708090;"># - "first_rules.yml"</span>
  <span class="token comment" style="color: #708090;"># - "second_rules.yml"</span>

<span class="token comment" style="color: #708090;"># A scrape configuration containing exactly one endpoint to scrape:</span>
<span class="token comment" style="color: #708090;"># Here it's Prometheus itself.</span>
<span class="token key atrule" style="color: #0077aa;">scrape_configs</span><span class="token punctuation" style="color: #999999;">:</span>
  <span class="token comment" style="color: #708090;"># The job name is added as a label `job=&lt;job_name&gt;` to any timeseries scraped from this config.</span>
  <span class="token punctuation" style="color: #999999;">-</span> <span class="token key atrule" style="color: #0077aa;">job_name</span><span class="token punctuation" style="color: #999999;">:</span> <span class="token string" style="color: #669900;">'prometheus'</span>
    <span class="token comment" style="color: #708090;"># metrics_path defaults to '/metrics'</span>
    <span class="token comment" style="color: #708090;"># scheme defaults to 'http'.</span>
    <span class="token key atrule" style="color: #0077aa;">static_configs</span><span class="token punctuation" style="color: #999999;">:</span>
    <span class="token punctuation" style="color: #999999;">-</span> <span class="token key atrule" style="color: #0077aa;">targets</span><span class="token punctuation" style="color: #999999;">:</span> <span class="token punctuation" style="color: #999999;">[</span><span class="token string" style="color: #669900;">'127.0.0.1:9090'</span><span class="token punctuation" style="color: #999999;">]</span>

  <span class="token punctuation" style="color: #999999;">-</span> <span class="token key atrule" style="color: #0077aa;">job_name</span><span class="token punctuation" style="color: #999999;">:</span> <span class="token string" style="color: #669900;">'spring-actuator'</span>
    <span class="token key atrule" style="color: #0077aa;">metrics_path</span><span class="token punctuation" style="color: #999999;">:</span> <span class="token string" style="color: #669900;">'/actuator/prometheus'</span>
    <span class="token key atrule" style="color: #0077aa;">scrape_interval</span><span class="token punctuation" style="color: #999999;">:</span> 5s
    <span class="token key atrule" style="color: #0077aa;">static_configs</span><span class="token punctuation" style="color: #999999;">:</span>
    <span class="token punctuation" style="color: #999999;">-</span> <span class="token key atrule" style="color: #0077aa;">targets</span><span class="token punctuation" style="color: #999999;">:</span> <span class="token punctuation" style="color: #999999;">[</span><span class="token string" style="color: #669900;">'HOST_IP:8080'</span><span class="token punctuation" style="color: #999999;">]</span>
</code></pre> 
 <p style="">The above configuration file is an extension of the&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://prometheus.io/docs/prometheus/latest/getting_started/#configuring-prometheus-to-monitor-itself">basic configuration file</a>&nbsp;available in the Prometheus documentation.</p> 
 <p style="">The most important stuff to note in the above configuration file is the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">spring-actuator</code>&nbsp;job inside&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">scrape_configs</code>&nbsp;section.</p> 
 <p style="">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">metrics_path</code>&nbsp;is the path of the Actuator’s&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">prometheus</code>&nbsp;endpoint. The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">targets</code>&nbsp;section contains the HOST and PORT of your Spring Boot application.</p> 
 <p style="">Please make sure to replace the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">HOST_IP</code>&nbsp;with the IP address of the machine where your Spring Boot application is running. Note that,&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">localhost</code>&nbsp;won’t work here because we’ll be connecting to the HOST machine from the docker container. You must specify the network IP address.</p> 
 <h3 id="3-running-prometheus-using-docker" style="">3. Running Prometheus using Docker</h3> 
 <p style="">Finally, Let’s run Prometheus using Docker. Type the following command to start a Prometheus server in the background -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker run -d --name<span class="token operator" style="color: #a67f59;">=</span>prometheus -p 9090:9090 -v <span class="token operator" style="color: #a67f59;">&lt;</span>PATH_TO_prometheus.yml_FILE<span class="token operator" style="color: #a67f59;">&gt;</span>:/etc/prometheus/prometheus.yml prom/prometheus --config.file<span class="token operator" style="color: #a67f59;">=</span>/etc/prometheus/prometheus.yml
</code></pre> 
 <p style="">Please make sure to replace the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">&lt;PATH_TO_prometheus.yml_FILE&gt;</code>&nbsp;with the PATH where you have stored the Prometheus configuration file.</p> 
 <p style="">After running the above command, docker will start the Prometheus server inside a container. You can see the list of all the containers with the following command -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker container <span class="token function" style="color: #dd4a68;">ls</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                    NAMES
e036eb20b8ad        prom/prometheus     <span class="token string" style="color: #669900;">"/bin/prometheus --c…"</span>   4 minutes ago       Up 4 minutes        0.0.0.0:9090-<span class="token operator" style="color: #a67f59;">&gt;</span>9090/tcp   prometheus
</code></pre> 
 <h3 id="4-visualizing-spring-boot-metrics-from-prometheus-dashboard" style="">4. Visualizing Spring Boot Metrics from Prometheus dashboard</h3> 
 <p style="">That’s it! You can now navigate to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:9090</code>&nbsp;to explore the Prometheus dashboard.</p> 
 <p style="">You can enter a Prometheus query expression inside the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">Expression</code>&nbsp;text field and visualize all the metrics for that query.</p> 
 <p style="">Following are some Prometheus graphs for our Spring Boot application’s metrics -</p> 
 <ul style=""> 
  <li style="">System’s CPU usage -</li> 
 </ul> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-metrics-dashboard-prometheus-graph.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-metrics-dashboard-prometheus-graph.jpg" alt="Spring Boot Actuator Metrics Dashboard Prometheus"></p> 
 <ul style=""> 
  <li style="">Response latency of a slow API -</li> 
 </ul> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-prometheus-dashboard-graph-example.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-prometheus-dashboard-graph-example.jpg" alt="Spring Boot Actuator Prometheus Dashboard Graph Example"></p> 
 <p style="">You can check out the official Prometheus documentation to learn more about&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://prometheus.io/docs/introduction/first_steps/#using-the-expression-browser"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">Prometheus Query Expressions</code></a>.</p> 
 <div class="adsense-code-block" style="">
  <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;"><ins id="aswift_1_expand" style="display: inline-table; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;"><ins id="aswift_1_anchor" style="display: block; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;">&lt;iframe id="aswift_1" style="box-sizing: border-box; left: 0px; position: absolute; top: 0px; width: 300px; height: 250px;" name="aswift_1" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="300" height="250"&gt;&lt;/iframe&gt;</ins></ins></ins>
 </div> 
 <h2 id="downloading-and-running-grafana-using-docker" style="">Downloading and running Grafana using Docker</h2> 
 <p style="">Type the following command to download and run Grafana using Docker -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker run -d --name<span class="token operator" style="color: #a67f59;">=</span>grafana -p 3000:3000 grafana/grafana 
</code></pre> 
 <p style="">The above command will start Grafana inside a Docker container and make it available on port&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">3000</code>&nbsp;on the Host machine.</p> 
 <p style="">You can type&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">docker container ls</code>&nbsp;to see the list of Docker containers -</p> 
 <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">$ docker container <span class="token function" style="color: #dd4a68;">ls</span>
CONTAINER ID        IMAGE               COMMAND                  CREATED                  STATUS              PORTS                    NAMES
cf9196b30d0d        grafana/grafana     <span class="token string" style="color: #669900;">"/run.sh"</span>                Less than a second ago   Up 5 seconds        0.0.0.0:3000-<span class="token operator" style="color: #a67f59;">&gt;</span>3000/tcp   grafana
e036eb20b8ad        prom/prometheus     <span class="token string" style="color: #669900;">"/bin/prometheus --c…"</span>   16 minutes ago           Up 16 minutes       0.0.0.0:9090-<span class="token operator" style="color: #a67f59;">&gt;</span>9090/tcp   prometheus
</code></pre> 
 <p style="">That’s it! You can now navigate to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:3000</code>&nbsp;and log in to Grafana with the default username&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">admin</code>&nbsp;and password&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">admin</code>.</p> 
 <h3 id="configuring-grafana-to-import-metrics-data-from-prometheus" style="">Configuring Grafana to import metrics data from Prometheus</h3> 
 <p style="">Follow the steps below to import metrics from Prometheus and visualize them on Grafana:</p> 
 <h4 id="1-add-the-prometheus-data-source-in-grafana" style="">1. Add the Prometheus data source in Grafana</h4> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-prometheus-grafana-dashboard.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-prometheus-grafana-dashboard.jpg" alt="Spring Boot Actuator Prometheus Grafana Dashboard"></p> 
 <h4 id="2-create-a-new-dashboard-with-a-graph" style="">2. Create a new Dashboard with a Graph</h4> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-grafana-dashboard-create-graph.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-grafana-dashboard-create-graph.jpg" alt="Spring Boot Actuator Grafana Dashboard Create Graph"></p> 
 <h4 id="3-add-a-prometheus-query-expression-in-grafana-s-query-editor" style="">3. Add a Prometheus Query expression in Grafana’s query editor</h4> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-grafana-dashboard-prometheus-metrics-graph.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-grafana-dashboard-prometheus-metrics-graph.jpg" alt="Spring Boot Actuator Grafana Dashboard Prometheus Metrics Graph"></p> 
 <h4 id="4-visualize-metrics-from-grafana-s-dashboard" style="">4. Visualize metrics from Grafana’s dashboard</h4> 
 <p>&lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-dashboard-visualize-prometheus-metrics-graph.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;<img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-dashboard-visualize-prometheus-metrics-graph.jpg" alt="Spring Boot Actuator Grafana Dashboard Visualize Prometheus metrics graph"></p> 
 <p style=""><em style="">You can find the complete source code for the Actuator Demo application on&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://github.com/callicoder/spring-boot-actuator-demo">Github</a>.</em></p> 
 <p style=""><span style="font-weight: 600;">Read the First Part:</span>&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.callicoder.com/spring-boot-actuator/">Spring Boot Actuator: Health check, Auditing, Metrics gathering and Monitoring</a></p> 
 <h2 id="more-learning-resources" style="">More Learning Resources</h2> 
 <ul style=""> 
  <li style=""> <p style="margin-bottom: 15px;"><a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-metrics.html">Spring Boot Production-ready Metrics</a></p> </li> 
  <li style=""> <p style="margin-bottom: 15px;"><a style="background-color: transparent; color: #419be8;" href="https://prometheus.io/docs/introduction/first_steps/">First Steps with Prometheus</a></p> </li> 
  <li style=""> <p style="margin-bottom: 15px;"><a style="background-color: transparent; color: #419be8;" href="http://docs.grafana.org/features/datasources/prometheus/">Using Prometheus in Grafana</a></p> </li> 
 </ul> 
</div>