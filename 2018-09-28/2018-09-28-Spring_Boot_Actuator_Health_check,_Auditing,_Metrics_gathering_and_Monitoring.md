#Spring Boot Actuator: Health check, Auditing, Metrics gathering and Monitoring
###发表时间：2018-09-28
###分类：Spring,springboot,java,springboot-actuator
###iteye原始地址：<a href="https://kanpiaoxue.iteye.com/admin/blogs/2431483" target="_blank">https://kanpiaoxue.iteye.com/admin/blogs/2431483</a>

---

<div class="iteye-blog-content-contain" style="font-size: 14px;"> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <p>参考地址：&nbsp;<a href="https://www.callicoder.com/spring-boot-actuator/">https://www.callicoder.com/spring-boot-actuator/</a></p> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <p>&nbsp;</p> 
 <h1 class="post-title" style="">Spring Boot Actuator: Health check, Auditing, Metrics gathering and Monitoring</h1> 
 <p>&nbsp;</p> 
 <p style="">Spring Boot Actuator module helps you monitor and manage your Spring Boot application by providing production-ready features like health check-up, auditing, metrics gathering, HTTP tracing etc. All of these features can be accessed over JMX or HTTP endpoints.</p> 
 <p style="">Actuator also integrates with external application monitoring systems like&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://prometheus.io/">Prometheus</a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://graphiteapp.org/">Graphite</a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.datadoghq.com/">DataDog</a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.influxdata.com/">Influx</a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.wavefront.com/">Wavefront</a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://newrelic.com/">New Relic</a>&nbsp;and many more. These systems provide you with excellent dashboards, graphs, analytics, and alarms to help you monitor and manage your application from one unified interface.</p> 
 <p style="">Actuator uses&nbsp;<a style="background-color: transparent; color: #419be8;" href="http://micrometer.io/">Micrometer</a>, an application metrics facade to integrate with these external application monitoring systems. This makes it super easy to plug-in any application monitoring system with very little configuration.</p> 
 <p style="">I’ve divided the Spring Boot Actuator tutorial into two parts -</p> 
 <ul style=""> 
  <li style=""> <p style="margin-bottom: 15px;">The first part (this article) teaches you how to configure Actuator in a spring boot application and access its features via HTTP endpoints.</p> </li> 
  <li style=""> <p style="margin-bottom: 15px;">The&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/">second part</a>&nbsp;will teach you how to integrate Actuator with an external application monitoring system.</p> </li> 
 </ul> 
 <div class="primary-content" style=""> 
  <div class="post-content" style="margin-bottom: 30px;"> 
   <h2 id="creating-a-spring-boot-application-with-actuator" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Creating a Spring Boot application with Actuator</h2> 
   <p style="margin-bottom: 15px;">Let’s create a simple Spring Boot application with actuator dependency so that we can explore all its features in this article.</p> 
   <p style="margin-bottom: 15px;">You can create the app using&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/reference/htmlsingle/#getting-started-installing-the-cli">Spring Boot CLI</a>&nbsp;like so -</p> 
   <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">spring init -d<span class="token operator" style="color: #a67f59;">=</span>web,actuator -n<span class="token operator" style="color: #a67f59;">=</span>actuator-demo actuator-demo
</code></pre> 
   <p style="margin-bottom: 15px;">Alternatively, you can generate the app from&nbsp;<a style="background-color: transparent; color: #419be8;" href="http://start.spring.io/">Spring Initializr</a>&nbsp;website -</p> &lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-metrics-monitoring-demo-application-example.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;
   <img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-metrics-monitoring-demo-application-example.jpg" alt="Spring Boot Actuator Metrics Monitoring Demo Application Example">
   <h2 id="adding-spring-boot-actuator-to-an-existing-application" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Adding Spring Boot Actuator to an existing application</h2> 
   <p style="margin-bottom: 15px;">You can add&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">spring-boot-actuator</code>&nbsp;module to an existing spring boot application using the following dependency.</p> 
   <pre class=" language-xml"><code class=" language-xml" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>dependencies</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
	<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
		<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>org.springframework.boot<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
		<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>spring-boot-starter-actuator<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
	<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>dependencies</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
</code></pre> 
   <p style="margin-bottom: 15px;">For Gradle, add the dependency like this -</p> 
   <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">dependencies <span class="token punctuation" style="color: #999999;">{</span>
	compile<span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"org.springframework.boot:spring-boot-starter-actuator"</span><span class="token punctuation" style="color: #999999;">)</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h2 id="monitoring-your-application-through-actuator-endpoints" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Monitoring your application through Actuator Endpoints</h2> 
   <p style="margin-bottom: 15px;">Actuator creates several so-called&nbsp;<span style="font-weight: 600;">endpoints</span>&nbsp;that can be exposed over HTTP or JMX to let you monitor and interact with your application.</p> 
   <p style="margin-bottom: 15px;">For example, There is a&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/health</code>&nbsp;endpoint that provides basic information about the application’s health. The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/metrics</code>&nbsp;endpoint shows several useful metrics information like JVM memory used, system CPU usage, open files, and much more. The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/loggers</code>&nbsp;endpoint shows application’s logs and also lets you change the log level at runtime.</p> 
   <p style="margin-bottom: 15px;"><span style="font-weight: 600;">Note that, every actuator endpoint can be&nbsp;<em style="">explicitly</em>&nbsp;enabled and disabled. Moreover, the endpoints also need to be exposed over HTTP or JMX to make them remotely accessible.</span></p> 
   <p style="margin-bottom: 15px;">Let’s first run the application and try to access the actuator endpoints that are enabled and exposed over HTTP by default. After that, we’ll learn how to enable more actuator endpoints and also expose them over HTTP.</p> 
   <p style="margin-bottom: 15px;">Type the following command from the root directory of the application to run it -</p> 
   <pre class=" language-bash"><code class=" language-bash" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;">mvn spring-boot:run
</code></pre> 
   <p style="margin-bottom: 15px;">The application will start on port&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">8080</code>&nbsp;by default. Once the application has started, you can list all the actuator endpoints exposed over HTTP from the URL&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator</code>.</p> &lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-default-exposed-actuator-endpoints.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;
   <img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-default-exposed-actuator-endpoints.jpg" alt="Spring Boot default exposed Actuator endpoints">
   <p style="margin-bottom: 15px;">Let’s explore the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint by opening the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/health</code>&nbsp;URL. The endpoint should display the following -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
    <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span> <span class="token string" style="color: #669900;">"UP"</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">The status will be&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">UP</code>&nbsp;as long as the application is healthy. It will show&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DOWN</code>&nbsp;if the application gets unhealthy due to any issue like connectivity with the database or lack of disk space etc. Check out the next section to learn more about how Spring Boot determines the health of your application and how you can tweak it.</p> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoint (<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/info</code>) displays general information about your application obtained from build files like&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">META-INF/build-info.properties</code>&nbsp;or Git files like&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">git.properties</code>&nbsp;or through any environment property under the key&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>. You’ll learn how to tweak the output of this endpoint in the next section.</p> 
   <p style="margin-bottom: 15px;"><span style="font-weight: 600;">By default, only the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;and&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoints are exposed over HTTP</span>. That’s why the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/actuator</code>&nbsp;page lists only the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;and&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoints. We’ll learn how to expose other endpoints shortly. First, Let’s see what those endpoints are and what do they offer you.</p> 
   <p style="margin-bottom: 15px;">Following is a list of some super useful actuator endpoints. You can see the complete list on the&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready-endpoints.html">official documentation</a>.</p> 
   <table style="border-spacing: 0px; border-collapse: collapse; margin-bottom: 15px;"> 
    <thead style="">
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <th style="padding: 6px 13px; border: 1px solid #dfe2e5;">Endpoint ID</th> 
      <th style="padding: 6px 13px; border: 1px solid #dfe2e5;">Description</th> 
     </tr>
    </thead> 
    <tbody style=""> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">auditevents</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Exposes audit events (e.g. auth_success, order_failed) for your application</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">info</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays information about your application.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">health</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays your application’s health status.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">metrics</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Shows various metrics information of your application.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">loggers</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays and modifies the configured loggers.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">logfile</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Returns the contents of the log file (if&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">logging.file</code>&nbsp;or&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">logging.path</code>&nbsp;properties are set.)</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">httptrace</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays HTTP trace info for the last 100 HTTP request/response.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">env</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays current environment properties.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">flyway</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Shows details of Flyway database migrations.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">liquidbase</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Shows details of Liquibase database migrations.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">shutdown</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Lets you shut down the application gracefully.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">mappings</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays a list of all @RequestMapping paths.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">scheduledtasks</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Displays the scheduled tasks in your application.</td> 
     </tr> 
     <tr style="background-color: #f6f8fa; border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">threaddump</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Performs a thread dump.</td> 
     </tr> 
     <tr style="border-top: 1px solid #c6cbd1;"> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">heapdump</td> 
      <td style="padding: 6px 13px; border: 1px solid #dfe2e5;">Returns a GZip compressed JVM heap dump.</td> 
     </tr> 
    </tbody> 
   </table> 
   <div class="adsense-code-block" style="margin: 39px auto; text-align: center;">
    <ins class="adsbygoogle" style="display: inline-block; width: 300px; height: 250px;"><ins id="aswift_1_expand" style="display: inline-table; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;"><ins id="aswift_1_anchor" style="display: block; border: none; height: 250px; margin: 0px; padding: 0px; width: 300px; background-color: transparent;">&lt;iframe id="aswift_1" style="box-sizing: border-box; left: 0px; position: absolute; top: 0px; width: 300px; height: 250px;" name="aswift_1" frameborder="0" marginwidth="0" marginheight="0" scrolling="no" width="300" height="250"&gt;&lt;/iframe&gt;</ins></ins></ins>
   </div> 
   <h2 id="enabling-and-disabling-actuator-endpoints" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Enabling and Disabling Actuator Endpoints</h2> 
   <p style="margin-bottom: 15px;">By default, all the endpoints that I listed in the previous section are enabled except the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">shutdown</code>&nbsp;endpoint.</p> 
   <p style="margin-bottom: 15px;">You can enable or disable an actuator endpoint by setting the property&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">management.endpoint.&lt;id&gt;.enabled</code>&nbsp;to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">true</code>&nbsp;or&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">false</code>&nbsp;(where&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">id</code>&nbsp;is the identifier for the endpoint).</p> 
   <p style="margin-bottom: 15px;">For example, to enable the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">shutdown</code>&nbsp;endpoint, add the following to your&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">application.properties</code>&nbsp;file -</p> 
   <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token attr-name" style="color: #669900;">management.endpoint.shutdown.enabled</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">true</span>
</code></pre> 
   <h2 id="exposing-actuator-endpoints" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Exposing Actuator Endpoints</h2> 
   <p style="margin-bottom: 15px;">By default, all the actuator endpoints are exposed over JMX but only the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;and&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoints are exposed over HTTP.</p> 
   <p style="margin-bottom: 15px;">Here is how you can expose actuator endpoints over HTTP and JMX using application properties -</p> 
   <ul style="margin-bottom: 15px; margin-left: 30px;"> 
    <li style=""> <p style="margin-bottom: 15px;"><span style="font-weight: 600;">Exposing Actuator endpoints over HTTP</span></p> <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># Use "*" to expose all endpoints, or a comma-separated list to expose selected ones</span>
<span class="token attr-name" style="color: #669900;">management.endpoints.web.exposure.include</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">health,info </span>
<span class="token attr-name" style="color: #669900;">management.endpoints.web.exposure.exclude</span><span class="token punctuation" style="color: #999999;">=</span>
</code></pre> </li> 
    <li style=""> <p style="margin-bottom: 15px;"><span style="font-weight: 600;">Exposing Actuator endpoints over JMX</span></p> <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># Use "*" to expose all endpoints, or a comma-separated list to expose selected ones</span>
<span class="token attr-name" style="color: #669900;">management.endpoints.jmx.exposure.include</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">*</span>
<span class="token attr-name" style="color: #669900;">management.endpoints.jmx.exposure.exclude</span><span class="token punctuation" style="color: #999999;">=</span>
</code></pre> </li> 
   </ul> 
   <p style="margin-bottom: 15px;">Let’s expose all actuator endpoints by setting the property&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">management.endpoints.web.exposure.include</code>to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">*</code>&nbsp;and check the output of&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator</code>&nbsp;page. You’ll notice that the actuator page now lists all the enabled endpoints-</p> &lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-endpoints.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;
   <img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-endpoints.jpg" alt="Spring Boot Actuator Endpoints">
   <h2 id="exploring-common-actuator-endpoints" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Exploring common actuator endpoints</h2> 
   <h3 id="health-endpoint" style="margin-top: 30px; margin-bottom: 30px; font-size: 24px; line-height: 1.3;">/health endpoint</h3> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint checks the health of your application by combining several health indicators.</p> 
   <p style="margin-bottom: 15px;">Spring Boot Actuator comes with several predefined health indicators like&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/jdbc/DataSourceHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DataSourceHealthIndicator</code></a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/system/DiskSpaceHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DiskSpaceHealthIndicator</code></a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/mongo/MongoHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">MongoHealthIndicator</code></a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/redis/RedisHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">RedisHealthIndicator</code></a>,&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/cassandra/CassandraHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">CassandraHealthIndicator</code></a>&nbsp;etc. It uses these health indicators as part of the health check-up process.</p> 
   <p style="margin-bottom: 15px;">For example, If your application uses&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">Redis</code>, the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">RedisHealthIndicator</code>&nbsp;will be used as part of the health check-up. If your application uses&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">MongoDB</code>, the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">MongoHealthIndicator</code>&nbsp;will be used as part of the health check-up and so on.</p> 
   <p style="margin-bottom: 15px;">You can also disable a particular health indicator using application properties like so -</p> 
   <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token attr-name" style="color: #669900;">management.health.mongo.enabled</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">false</span>
</code></pre> 
   <p style="margin-bottom: 15px;">But by default, all these health indicators are enabled and used as part of the health check-up process.</p> 
   <h4 id="displaying-detailed-health-information" style="margin-top: 20px; margin-bottom: 20px; font-size: 20px; line-height: 1.3;">Displaying detailed health information</h4> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint only shows a simple&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">UP</code>&nbsp;or&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DOWN</code>&nbsp;status. To get the complete details including the status of every health indicator that was checked as part of the health check-up process, add the following property in the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">application.properties</code>&nbsp;file -</p> 
   <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># HEALTH ENDPOINT</span>
<span class="token attr-name" style="color: #669900;">management.endpoint.health.show-details</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">always</span>
</code></pre> 
   <p style="margin-bottom: 15px;">Once you do that, the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint will display more details like this -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
      <span class="token property" style="color: #990055;">"diskSpace"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"total"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">250790436864</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"free"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">100327518208</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"threshold"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">10485760</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint now includes the details of the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DiskSpaceHealthIndicator</code>&nbsp;which is run as part of the health checkup process.</p> 
   <p style="margin-bottom: 15px;">If your application has a database (say MySQL), the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint will show the status of that as well -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
      <span class="token property" style="color: #990055;">"db"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"database"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"MySQL"</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"hello"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">1</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"diskSpace"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"total"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">250790436864</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"free"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">100330897408</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"threshold"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">10485760</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">If your MySQL server goes down, the status will change to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DOWN</code>&nbsp;-</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"DOWN"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
      <span class="token property" style="color: #990055;">"db"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"DOWN"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"error"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is java.sql.SQLTransientConnectionException: HikariPool-1 - Connection is not available, request timed out after 30006ms."</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"diskSpace"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"total"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">250790436864</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"free"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">100324585472</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"threshold"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">10485760</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h4 id="creating-a-custom-health-indicator" style="margin-top: 20px; margin-bottom: 20px; font-size: 20px; line-height: 1.3;">Creating a Custom Health Indicator</h4> 
   <p style="margin-bottom: 15px;">You can also create a custom health indicator by implementing the&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/health/HealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">HealthIndicator</code></a>&nbsp;interface, or extending the&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/health/AbstractHealthIndicator.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">AbstractHealthIndicator</code></a>&nbsp;class -</p> 
   <pre class=" language-java"><code class=" language-java" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token keyword" style="color: #0077aa;">package</span> com<span class="token punctuation" style="color: #999999;">.</span>example<span class="token punctuation" style="color: #999999;">.</span>actuatordemo<span class="token punctuation" style="color: #999999;">.</span>health<span class="token punctuation" style="color: #999999;">;</span>

<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>boot<span class="token punctuation" style="color: #999999;">.</span>actuate<span class="token punctuation" style="color: #999999;">.</span>health<span class="token punctuation" style="color: #999999;">.</span>AbstractHealthIndicator<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>boot<span class="token punctuation" style="color: #999999;">.</span>actuate<span class="token punctuation" style="color: #999999;">.</span>health<span class="token punctuation" style="color: #999999;">.</span>Health<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>stereotype<span class="token punctuation" style="color: #999999;">.</span>Component<span class="token punctuation" style="color: #999999;">;</span>

<span class="token annotation punctuation" style="color: #999999;">@Component</span>
<span class="token keyword" style="color: #0077aa;">public</span> <span class="token keyword" style="color: #0077aa;">class</span> <span class="token class-name" style="">CustomHealthIndicator</span> <span class="token keyword" style="color: #0077aa;">extends</span> <span class="token class-name" style="">AbstractHealthIndicator</span> <span class="token punctuation" style="color: #999999;">{</span>

    <span class="token annotation punctuation" style="color: #999999;">@Override</span>
    <span class="token keyword" style="color: #0077aa;">protected</span> <span class="token keyword" style="color: #0077aa;">void</span> <span class="token function" style="color: #dd4a68;">doHealthCheck</span><span class="token punctuation" style="color: #999999;">(</span>Health<span class="token punctuation" style="color: #999999;">.</span>Builder builder<span class="token punctuation" style="color: #999999;">)</span> <span class="token keyword" style="color: #0077aa;">throws</span> Exception <span class="token punctuation" style="color: #999999;">{</span>
        <span class="token comment" style="color: #708090;">// Use the builder to build the health status details that should be reported.</span>
        <span class="token comment" style="color: #708090;">// If you throw an exception, the status will be DOWN with the exception message.</span>
        
        builder<span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">up</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">withDetail</span><span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"app"</span><span class="token punctuation" style="color: #999999;">,</span> <span class="token string" style="color: #669900;">"Alive and Kicking"</span><span class="token punctuation" style="color: #999999;">)</span>
                <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">withDetail</span><span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"error"</span><span class="token punctuation" style="color: #999999;">,</span> <span class="token string" style="color: #669900;">"Nothing! I'm good."</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">;</span>
    <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">Once you add the above health indicator in your application, the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">health</code>&nbsp;endpoint will start showing its details as well -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
      <span class="token property" style="color: #990055;">"custom"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"app"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"Alive and Kicking"</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"error"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"Nothing! I'm good."</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"diskSpace"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"status"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UP"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"details"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
            <span class="token property" style="color: #990055;">"total"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">250790436864</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"free"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">97949245440</span><span class="token punctuation" style="color: #999999;">,</span>
            <span class="token property" style="color: #990055;">"threshold"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">10485760</span>
         <span class="token punctuation" style="color: #999999;">}</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h3 id="metrics-endpoint" style="margin-top: 30px; margin-bottom: 30px; font-size: 24px; line-height: 1.3;">/metrics endpoint</h3> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">/metrics</code>&nbsp;endpoint lists all the metrics that are available for you to track.</p> &lt;source media="(max-width: 520px)" srcset="https://www.callicoder.com/assets/images/post/medium/spring-boot-actuator-metrics-endpoint.jpg" style="box-sizing: border-box;"&gt;&lt;/source&gt;
   <img style="" src="https://www.callicoder.com/assets/images/post/large/spring-boot-actuator-metrics-endpoint.jpg" alt="Spring Boot Actuator Metrics Endpoint">
   <p style="margin-bottom: 15px;">To get the details of an individual metric, you need to pass the metric name in the URL like this -</p> 
   <p style="margin-bottom: 15px;"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/metrics/{MetricName}</code>.</p> 
   <p style="margin-bottom: 15px;">For example, to get the details of&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">system.cpu.usage</code>&nbsp;metric, use the URL&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/metrics/system.cpu.usage</code>. This will display the details in JSON format like so -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"name"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"system.cpu.usage"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"measurements"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">[</span>
      <span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"statistic"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"VALUE"</span><span class="token punctuation" style="color: #999999;">,</span>
         <span class="token property" style="color: #990055;">"value"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token number" style="color: #990055;">0.11774479321066383</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">]</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"availableTags"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">[</span>

   <span class="token punctuation" style="color: #999999;">]</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h3 id="loggers-endpoint" style="margin-top: 30px; margin-bottom: 30px; font-size: 24px; line-height: 1.3;">/loggers endpoint</h3> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">loggers</code>&nbsp;endpoint, which can be accessed at&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/loggers</code>, displays a list of all the configured loggers in your application with their corresponding log levels.</p> 
   <p style="margin-bottom: 15px;">You can also view the details of an individual logger by passing the logger name in the URL like this -</p> 
   <p style="margin-bottom: 15px;"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/loggers/{name}</code>.</p> 
   <p style="margin-bottom: 15px;">For example, to get the details of the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">root</code>&nbsp;logger, use the URL&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/loggers/root</code>.</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"configuredLevel"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"INFO"</span><span class="token punctuation" style="color: #999999;">,</span>
   <span class="token property" style="color: #990055;">"effectiveLevel"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"INFO"</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h4 id="changing-log-levels-at-runtime" style="margin-top: 20px; margin-bottom: 20px; font-size: 20px; line-height: 1.3;">Changing log levels at runtime.</h4> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">loggers</code>&nbsp;endpoint also allows you to change the log level of a given logger in your application at&nbsp;<span style="font-weight: 600;">runtime</span>.</p> 
   <p style="margin-bottom: 15px;">For example, To change the log level of the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">root</code>&nbsp;logger to&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DEBUG</code>&nbsp;at runtime, make a&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">POST</code>&nbsp;request to the URL&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/loggers/root</code>&nbsp;with the following payload -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"configuredLevel"</span><span class="token operator" style="color: #a67f59;">:</span> <span class="token string" style="color: #669900;">"DEBUG"</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">This functionality will really be useful in cases when your application is facing issues in production and you want to enable&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">DEBUG</code>&nbsp;logging for some time to get more details about the issue.</p> 
   <p style="margin-bottom: 15px;">To reset the log-level to the default value, you can pass a value of&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">null</code>&nbsp;in the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">configuredLevel</code>&nbsp;field.</p> 
   <h3 id="info-endpoint" style="margin-top: 30px; margin-bottom: 30px; font-size: 24px; line-height: 1.3;">/info endpoint</h3> 
   <p style="margin-bottom: 15px;">The&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoint displays arbitrary information about your application. It obtains build information from&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">META-INF/build-info.properties</code>&nbsp;file, Git information from&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">git.properties</code>&nbsp;file. It also displays any information available in environment properties under the key&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>.</p> 
   <p style="margin-bottom: 15px;">You can add properties under the key&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;in&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">application.properties</code>&nbsp;file like so -</p> 
   <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># INFO ENDPOINT CONFIGURATION</span>
<span class="token attr-name" style="color: #669900;">info.app.name</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">@project.name@</span>
<span class="token attr-name" style="color: #669900;">info.app.description</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">@project.description@</span>
<span class="token attr-name" style="color: #669900;">info.app.version</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">@project.version@</span>
<span class="token attr-name" style="color: #669900;">info.app.encoding</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">@project.build.sourceEncoding@</span>
<span class="token attr-name" style="color: #669900;">info.app.java.version</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">@java.version@</span>
</code></pre> 
   <p style="margin-bottom: 15px;">Note that, I’m using Spring Boot’s&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/reference/html/howto-properties-and-configuration.html#howto-automatic-expansion">Automatic property expansion</a>&nbsp;feature to expand properties from the maven project.</p> 
   <p style="margin-bottom: 15px;">Once you add the above properties, the&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">info</code>&nbsp;endpoint (<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">http://localhost:8080/actuator/info</code>) will start displaying the information like so -</p> 
   <pre class=" language-json"><code class=" language-json" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token punctuation" style="color: #999999;">{</span>
   <span class="token property" style="color: #990055;">"app"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
      <span class="token property" style="color: #990055;">"name"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"actuator-demo"</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"description"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"Spring Boot Actuator Demo Project"</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"version"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"0.0.1-SNAPSHOT"</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"encoding"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"UTF-8"</span><span class="token punctuation" style="color: #999999;">,</span>
      <span class="token property" style="color: #990055;">"java"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token punctuation" style="color: #999999;">{</span>
         <span class="token property" style="color: #990055;">"version"</span><span class="token operator" style="color: #a67f59;">:</span><span class="token string" style="color: #669900;">"1.8.0_112"</span>
      <span class="token punctuation" style="color: #999999;">}</span>
   <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <h2 id="securing-actuator-endpoints-with-spring-security" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">Securing Actuator Endpoints with Spring Security</h2> 
   <p style="margin-bottom: 15px;">Actuator endpoints are sensitive and must be secured from unauthorized access. If Spring Security is present in your application, then the endpoints are secured by default using a form-based HTTP basic authentication.</p> 
   <p style="margin-bottom: 15px;">If not, you can add spring security to your application using the following dependency -</p> 
   <pre class=" language-xml"><code class=" language-xml" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
   <span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>org.springframework.boot<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>groupId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
   <span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>spring-boot-starter-security<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>artifactId</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
<span class="token tag" style="color: #990055;"><span class="token tag" style=""><span class="token punctuation" style="color: #999999;">&lt;/</span>dependency</span><span class="token punctuation" style="color: #999999;">&gt;</span></span>
</code></pre> 
   <p style="margin-bottom: 15px;">Let’s now see how we can override the default spring security configuration and define our own access rules.</p> 
   <p style="margin-bottom: 15px;">The following example shows a sample spring security configuration that uses a convenient&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">RequestMatcher</code>factory called&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/api/org/springframework/boot/actuate/autoconfigure/security/servlet/EndpointRequest.html"><code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">EndPointRequest</code></a>&nbsp;provided by&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">spring-boot-actuator</code>&nbsp;module to configure access rules for Actuator endpoints -</p> 
   <pre class=" language-java"><code class=" language-java" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token keyword" style="color: #0077aa;">package</span> com<span class="token punctuation" style="color: #999999;">.</span>example<span class="token punctuation" style="color: #999999;">.</span>actuatordemo<span class="token punctuation" style="color: #999999;">.</span>config<span class="token punctuation" style="color: #999999;">;</span>

<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>boot<span class="token punctuation" style="color: #999999;">.</span>actuate<span class="token punctuation" style="color: #999999;">.</span>autoconfigure<span class="token punctuation" style="color: #999999;">.</span>security<span class="token punctuation" style="color: #999999;">.</span>servlet<span class="token punctuation" style="color: #999999;">.</span>EndpointRequest<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>boot<span class="token punctuation" style="color: #999999;">.</span>actuate<span class="token punctuation" style="color: #999999;">.</span>context<span class="token punctuation" style="color: #999999;">.</span>ShutdownEndpoint<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>boot<span class="token punctuation" style="color: #999999;">.</span>autoconfigure<span class="token punctuation" style="color: #999999;">.</span>security<span class="token punctuation" style="color: #999999;">.</span>servlet<span class="token punctuation" style="color: #999999;">.</span>PathRequest<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>context<span class="token punctuation" style="color: #999999;">.</span>annotation<span class="token punctuation" style="color: #999999;">.</span>Configuration<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>security<span class="token punctuation" style="color: #999999;">.</span>config<span class="token punctuation" style="color: #999999;">.</span>annotation<span class="token punctuation" style="color: #999999;">.</span>web<span class="token punctuation" style="color: #999999;">.</span>builders<span class="token punctuation" style="color: #999999;">.</span>HttpSecurity<span class="token punctuation" style="color: #999999;">;</span>
<span class="token keyword" style="color: #0077aa;">import</span> org<span class="token punctuation" style="color: #999999;">.</span>springframework<span class="token punctuation" style="color: #999999;">.</span>security<span class="token punctuation" style="color: #999999;">.</span>config<span class="token punctuation" style="color: #999999;">.</span>annotation<span class="token punctuation" style="color: #999999;">.</span>web<span class="token punctuation" style="color: #999999;">.</span>configuration<span class="token punctuation" style="color: #999999;">.</span>WebSecurityConfigurerAdapter<span class="token punctuation" style="color: #999999;">;</span>

<span class="token annotation punctuation" style="color: #999999;">@Configuration</span>
<span class="token keyword" style="color: #0077aa;">public</span> <span class="token keyword" style="color: #0077aa;">class</span> <span class="token class-name" style="">ActuatorSecurityConfig</span> <span class="token keyword" style="color: #0077aa;">extends</span> <span class="token class-name" style="">WebSecurityConfigurerAdapter</span> <span class="token punctuation" style="color: #999999;">{</span>

    <span class="token comment" style="color: #708090;">/*
        This spring security configuration does the following

        1. Restrict access to the Shutdown endpoint to the ACTUATOR_ADMIN role.
        2. Allow access to all other actuator endpoints.
        3. Allow access to static resources.
        4. Allow access to the home page (/).
        5. All other requests need to be authenticated.
        5. Enable http basic authentication to make the configuration complete.
           You are free to use any other form of authentication.
     */</span>

    <span class="token annotation punctuation" style="color: #999999;">@Override</span>
    <span class="token keyword" style="color: #0077aa;">protected</span> <span class="token keyword" style="color: #0077aa;">void</span> <span class="token function" style="color: #dd4a68;">configure</span><span class="token punctuation" style="color: #999999;">(</span>HttpSecurity http<span class="token punctuation" style="color: #999999;">)</span> <span class="token keyword" style="color: #0077aa;">throws</span> Exception <span class="token punctuation" style="color: #999999;">{</span>
        http
                <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">authorizeRequests</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                    <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">requestMatchers</span><span class="token punctuation" style="color: #999999;">(</span>EndpointRequest<span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">to</span><span class="token punctuation" style="color: #999999;">(</span>ShutdownEndpoint<span class="token punctuation" style="color: #999999;">.</span><span class="token keyword" style="color: #0077aa;">class</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">)</span>
                        <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">hasRole</span><span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"ACTUATOR_ADMIN"</span><span class="token punctuation" style="color: #999999;">)</span>
                    <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">requestMatchers</span><span class="token punctuation" style="color: #999999;">(</span>EndpointRequest<span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">toAnyEndpoint</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">)</span>
                        <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">permitAll</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                    <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">requestMatchers</span><span class="token punctuation" style="color: #999999;">(</span>PathRequest<span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">toStaticResources</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">atCommonLocations</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">)</span>
                        <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">permitAll</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                    <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">antMatchers</span><span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"/"</span><span class="token punctuation" style="color: #999999;">)</span>
                        <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">permitAll</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                    <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">antMatchers</span><span class="token punctuation" style="color: #999999;">(</span><span class="token string" style="color: #669900;">"/**"</span><span class="token punctuation" style="color: #999999;">)</span>
                        <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">authenticated</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">and</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span>
                <span class="token punctuation" style="color: #999999;">.</span><span class="token function" style="color: #dd4a68;">httpBasic</span><span class="token punctuation" style="color: #999999;">(</span><span class="token punctuation" style="color: #999999;">)</span><span class="token punctuation" style="color: #999999;">;</span>
    <span class="token punctuation" style="color: #999999;">}</span>
<span class="token punctuation" style="color: #999999;">}</span>
</code></pre> 
   <p style="margin-bottom: 15px;">To be able to test the above configuration with HTTP basic authentication, you can add a default spring security user in&nbsp;<code style="font-family: monospace, monospace; font-size: 0.94em; background-color: #f6f8fa; border: 1px solid #f6f8fa; border-radius: 3px; padding: 1px 5px;">application.properties</code>&nbsp;like so -</p> 
   <pre class=" language-properties"><code class=" language-properties" style="font-family: monospace, monospace; font-size: 0.94em; background: 0px 0px; border: 0px; border-radius: 3px; padding: 1px 0px; line-height: 1.8;"><span class="token comment" style="color: #708090;"># Spring Security Default user name and password</span>
<span class="token attr-name" style="color: #669900;">spring.security.user.name</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">actuator</span>
<span class="token attr-name" style="color: #669900;">spring.security.user.password</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">actuator</span>
<span class="token attr-name" style="color: #669900;">spring.security.user.roles</span><span class="token punctuation" style="color: #999999;">=</span><span class="token attr-value" style="color: #0077aa;">ACTUATOR_ADMIN</span>
</code></pre> 
   <p style="margin-bottom: 15px;"><em style="">You can find the complete source code on&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://github.com/callicoder/spring-boot-actuator-demo">Github</a>.</em></p> 
   <p style="margin-bottom: 15px;"><span style="font-weight: 600;">Continue to the Next Part:</span>&nbsp;<a style="background-color: transparent; color: #419be8;" href="https://www.callicoder.com/spring-boot-actuator-metrics-monitoring-dashboard-prometheus-grafana/">Spring Boot Actuator metrics monitoring with Prometheus and Grafana</a></p> 
   <h2 id="more-learning-resources" style="margin-top: 30px; margin-bottom: 30px; font-size: 28px; line-height: 1.3;">More Learning Resources</h2> 
   <ul style="margin-bottom: 15px; margin-left: 30px;"> 
    <li style=""> <p style="margin-bottom: 15px;"><a style="background-color: transparent; color: #419be8;" href="https://docs.spring.io/spring-boot/docs/current/reference/html/production-ready.html">Spring Boot Actuator: Production-ready features</a></p> </li> 
    <li style=""> <p style="margin-bottom: 15px;"><a style="background-color: transparent; color: #419be8;" href="https://spring.io/blog/2018/03/16/micrometer-spring-boot-2-s-new-application-metrics-collector">Micrometer: Spring Boot 2’s new application metrics collector</a></p> </li> 
   </ul> 
  </div> 
 </div> 
</div>